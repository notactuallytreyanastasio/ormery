{ "version": 3, "file": "java/ormery/src/main/java/ormery/DemoController.java", "sources": [ "-work/src/demo-controller.temper.md" ], "sourcesContent": [ "# Demo Controller\n\nBusiness logic for the ORMery tutorial demo, written in Temper.\n\n## DemoController Class\n\n    export class DemoController(\n      public schema: Schema,\n      public store: InMemoryStore,\n    ) {\n      private var queryCount: Int;\n\n      public constructor(schema: Schema, store: InMemoryStore) {\n        this.schema = schema;\n        this.store = store;\n        queryCount = 0;\n      }\n\n      // Get total record count\n      public getRecordCount(): Int {\n        store.count(schema.tableName)\n      }\n\n      // Get count of adults (age \u003e= 18)\n      public getAdultCount(): Int {\n        new Query(schema, store)\n          .where(\u0022age\u0022, \u0022\u003e=\u0022, \u002218\u0022)\n          .all()\n          .length\n      }\n\n      // Get number of queries run\n      public getQueryCount(): Int {\n        queryCount\n      }\n\n      // Increment query counter\n      private incrementQueryCount(): Void {\n        queryCount = queryCount + 1;\n      }\n\n      // Format a list of records as text\n      private formatRecords(records: List\u003cRecord\u003e): String {\n        let lines = records.map { (record: Record): String =\u003e\n          \u0022  \u0024{record.describe()}\u0022\n        };\n        lines.join(\u0022\\n\u0022) { (s: String): String =\u003e s }\n      }\n\n      // Demo 1: Get all users\n      public runDemo1(): String {\n        incrementQueryCount();\n        let results = new Query(schema, store).all();\n        let formatted = formatRecords(results);\n        \u0022=== Demo 1: All Users ===\\n\\nQuery: new Query(userSchema, store).all()\\n\\nResults:\\n\u0024{formatted}\\n\\nTotal: \u0024{results.length} records\u0022\n      }\n\n      // Demo 2: Filter adults (age \u003e= 18)\n      public runDemo2(): String {\n        incrementQueryCount();\n        let results = new Query(schema, store)\n          .where(\u0022age\u0022, \u0022\u003e=\u0022, \u002218\u0022)\n          .all();\n        let formatted = formatRecords(results);\n        \u0022=== Demo 2: Filter Adults ===\\n\\nQuery: new Query(userSchema, store)\\n  .where(\\\u0022age\\\u0022, \\\u0022\u003e=\\\u0022, \\\u002218\\\u0022)\\n  .all()\\n\\nResults:\\n\u0024{formatted}\\n\\nTotal: \u0024{results.length} adults found\u0022\n      }\n\n      // Demo 3: Sort by age descending\n      public runDemo3(): String {\n        incrementQueryCount();\n        let results = new Query(schema, store)\n          .orderBy(\u0022age\u0022, \u0022desc\u0022)\n          .all();\n        let formatted = formatRecords(results);\n        \u0022=== Demo 3: Sort by Age (Descending) ===\\n\\nQuery: new Query(userSchema, store)\\n  .orderBy(\\\u0022age\\\u0022, \\\u0022desc\\\u0022)\\n  .all()\\n\\nResults (ordered by age, oldest first):\\n\u0024{formatted}\u0022\n      }\n\n      // Demo 4: Pagination\n      public runDemo4(): String {\n        incrementQueryCount();\n        let page1 = new Query(schema, store)\n          .orderBy(\u0022id\u0022, \u0022asc\u0022)\n          .limit(2)\n          .all();\n        let page2 = new Query(schema, store)\n          .orderBy(\u0022id\u0022, \u0022asc\u0022)\n          .offset(2)\n          .limit(2)\n          .all();\n        let formatted1 = formatRecords(page1);\n        let formatted2 = formatRecords(page2);\n        \u0022=== Demo 4: Pagination ===\\n\\nPage 1: .orderBy(\\\u0022id\\\u0022, \\\u0022asc\\\u0022).limit(2)\\n\\n\u0024{formatted1}\\n\\nPage 2: .orderBy(\\\u0022id\\\u0022, \\\u0022asc\\\u0022).offset(2).limit(2)\\n\\n\u0024{formatted2}\u0022\n      }\n\n      // Demo 5: Complex query with all features\n      public runDemo5(): String {\n        incrementQueryCount();\n        let results = new Query(schema, store)\n          .where(\u0022age\u0022, \u0022\u003e=\u0022, \u002218\u0022)\n          .where(\u0022email\u0022, \u0022!=\u0022, \u0022\u0022)\n          .orderBy(\u0022age\u0022, \u0022desc\u0022)\n          .select([\u0022name\u0022, \u0022age\u0022])\n          .limit(2)\n          .all();\n        let formatted = formatRecords(results);\n        \u0022=== Demo 5: Complex Query ===\\n\\nQuery: new Query(userSchema, store)\\n  .where(\\\u0022age\\\u0022, \\\u0022\u003e=\\\u0022, \\\u002218\\\u0022)\\n  .where(\\\u0022email\\\u0022, \\\u0022!=\\\u0022, \\\u0022\\\u0022)\\n  .orderBy(\\\u0022age\\\u0022, \\\u0022desc\\\u0022)\\n  .select([\\\u0022name\\\u0022, \\\u0022age\\\u0022])\\n  .limit(2)\\n  .all()\\n\\nResults (adults with email, showing name/age only, oldest first, max 2):\\n\u0024{formatted}\u0022\n      }\n    }\n" ], "names": [ "DemoController", "Schema", "schema", "InMemoryStore", "store", "queryCount", "t#3833", "Query", "t#734", "Record", "records", "fn", "record", "lines", "s", "results", "formatted", "page1", "page2", "formatted1", "formatted2" ], "mappings": "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" }